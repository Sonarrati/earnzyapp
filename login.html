<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - EARNZY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Poppins', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #16a34a, #22c55e, #0ea5a4); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
    <div class="max-w-md w-full mx-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <div class="flex items-center justify-center space-x-2 mb-4">
                <div class="w-12 h-12 gradient-bg rounded-full flex items-center justify-center">
                    <span class="text-white font-bold text-xl">‚Çπ</span>
                </div>
                <span class="text-3xl font-bold text-gray-800">EARNZY</span>
            </div>
            <h1 class="text-2xl font-bold text-gray-800 mb-2">Welcome Back!</h1>
            <p class="text-gray-600">Enter your mobile number to login or create account</p>
        </div>

        <!-- Login Card -->
        <div class="bg-white rounded-2xl shadow-lg p-8">
            <div class="text-center mb-6">
                <div class="w-16 h-16 gradient-bg rounded-full flex items-center justify-center mx-auto mb-4">
                    <span class="text-white text-2xl">üì±</span>
                </div>
                <h2 class="text-xl font-semibold">Mobile Number Login</h2>
                <p class="text-gray-600 text-sm mt-2">We'll send you an OTP to verify</p>
            </div>

            <!-- OTP Form -->
            <form id="loginForm" class="space-y-6">
                <!-- Mobile Input -->
                <div id="mobileSection">
                    <div class="flex items-center border-2 border-gray-200 rounded-xl px-4 py-3 focus-within:border-green-500 transition duration-300">
                        <span class="text-gray-500 mr-2">+91</span>
                        <input 
                            type="tel" 
                            id="mobileNumber" 
                            placeholder="Enter your mobile number" 
                            class="w-full outline-none bg-transparent"
                            maxlength="10"
                            pattern="[0-9]{10}"
                            required
                        >
                    </div>
                    <p class="text-green-600 text-sm mt-2 text-center">Get ‚Çπ2 signup bonus on first login!</p>
                </div>

                <!-- OTP Input (Hidden initially) -->
                <div id="otpSection" class="hidden">
                    <div class="text-center mb-4">
                        <p class="text-gray-600">Enter 6-digit OTP sent to <span id="mobileDisplay" class="font-semibold"></span></p>
                    </div>
                    <div class="flex space-x-2 justify-center mb-4">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                        <input type="text" maxlength="1" class="w-12 h-12 border-2 border-gray-200 rounded-xl text-center text-xl font-semibold focus:border-green-500 outline-none">
                    </div>
                    <div class="text-center">
                        <button type="button" id="resendOtp" class="text-green-600 text-sm hover:text-green-700 disabled:text-gray-400" disabled>
                            Resend OTP in <span id="countdown">60</span>s
                        </button>
                    </div>
                </div>

                <!-- reCAPTCHA Container -->
                <div id="recaptcha-container" class="flex justify-center"></div>

                <!-- Buttons -->
                <div id="mobileButtons">
                    <button type="submit" class="w-full gradient-bg text-white py-4 rounded-xl font-semibold hover:opacity-90 transition duration-300">
                        Send OTP
                    </button>
                </div>

                <div id="otpButtons" class="hidden space-y-3">
                    <button type="button" id="verifyOtp" class="w-full gradient-bg text-white py-4 rounded-xl font-semibold hover:opacity-90 transition duration-300">
                        Verify OTP
                    </button>
                    <button type="button" id="changeNumber" class="w-full border-2 border-gray-300 text-gray-700 py-4 rounded-xl font-semibold hover:bg-gray-50 transition duration-300">
                        Change Number
                    </button>
                </div>
            </form>

            <!-- Terms -->
            <div class="mt-6 text-center">
                <p class="text-xs text-gray-500">
                    By continuing, you agree to our 
                    <a href="#" class="text-green-600 hover:text-green-700">Terms</a> and 
                    <a href="#" class="text-green-600 hover:text-green-700">Privacy Policy</a>
                </p>
            </div>
        </div>

        <!-- Back to Home -->
        <div class="text-center mt-6">
            <a href="index.html" class="text-green-600 hover:text-green-700 font-semibold">‚Üê Back to Home</a>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module" src="js/firebase-init.js"></script>
    <script type="module" src="js/auth.js"></script>
    
    <script>
        // OTP Input handling
        const otpInputs = document.querySelectorAll('#otpSection input[type="text"]');
        otpInputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                if (e.target.value.length === 1 && index < otpInputs.length - 1) {
                    otpInputs[index + 1].focus();
                }
            });
            
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Backspace' && !e.target.value && index > 0) {
                    otpInputs[index - 1].focus();
                }
            });
        });

        // Change number handler
        document.getElementById('changeNumber').addEventListener('click', () => {
            document.getElementById('mobileSection').classList.remove('hidden');
            document.getElementById('otpSection').classList.add('hidden');
            document.getElementById('mobileButtons').classList.remove('hidden');
            document.getElementById('otpButtons').classList.add('hidden');
        });

        // Countdown timer
        function startCountdown() {
            let timeLeft = 60;
            const countdownElement = document.getElementById('countdown');
            const resendButton = document.getElementById('resendOtp');
            
            const timer = setInterval(() => {
                timeLeft--;
                countdownElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    resendButton.disabled = false;
                    resendButton.innerHTML = 'Resend OTP';
                }
            }, 1000);
        }
    </script>
</body>
</html>
